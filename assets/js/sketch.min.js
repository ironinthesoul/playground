let ship,scorebox,instructions,asteroids=[],newasteroids=10,lasers=[],destroyedradius=10,pointsmultiplier=100,score=0,framerate=60,mousetimeout=null,cursorvisible=!0;function setup(){createCanvas(windowWidth,windowHeight),frameRate(framerate),ship=new Ship;for(let e=0;e<newasteroids;e++)asteroids.push(new Asteroid);scorebox=createDiv(),scorebox.html("SCORE: 0"),scorebox.id("scoreboxdiv"),instructions=createDiv(),instructions.html("<strong>&lt;</strong> Rotate left <strong>&gt;</strong> Rotate right <strong>Z</strong> Boost <strong>Space bar</strong> Fire"),instructions.id("instructionsdiv");let e=getCookie("AsteroidsHighScore");e&&(highscorebox=createDiv(),highscorebox.html("HIGH SCORE: "+e),highscorebox.id("highscoreboxdiv"))}function draw(){background(0),keyIsDown(188)&&ship.setRotation(-.1),keyIsDown(190)&&ship.setRotation(.1),keyIsDown(90)&&ship.boosting(!0),0==asteroids.length&&gameIsOver(1);for(let e of asteroids){if(ship.hits(e)&&frameCount>3*framerate){gameIsOver();break}e.render(),e.update(),e.edges()}for(let e=lasers.length-1;e>=0;e--)if(lasers[e].render(),lasers[e].update(),lasers[e].offscreen())lasers.splice(e,1);else for(let s=asteroids.length-1;s>=0;s--)if(lasers[e].hits(asteroids[s])){if(asteroids[s].radius>destroyedradius){let e=asteroids[s].destroy();asteroids=asteroids.concat(e)}score+=asteroids[s].points*pointsmultiplier,asteroids.splice(s,1),lasers.splice(e,1),scorebox.html("SCORE: "+score);break}ship.render(),ship.turn(),ship.update(),ship.edges()}keyReleased=()=>{ship.setRotation(0),ship.boosting(!1)},keyPressed=()=>{32==keyCode&&lasers.push(new Laser(ship.pos,ship.heading))},gameIsOver=(e=0)=>{let s="GAME OVER";1==e&&(s="YOU WIN!");let o=getCookie("AsteroidsHighScore");score>o&&setCookie("AsteroidsHighScore",score,90),gameover=createDiv(),gameover.html(s),gameover.id("gameoverdiv"),gameover.center(),noLoop()},document.addEventListener("click",(e=>{e.target&&"gameoverdiv"==e.target.id&&(console.log("PRESSED"),window.location.reload())})),setCookie=(e,s,o)=>{let t="";if(o){let e=new Date;e.setTime(e.getTime()+24*o*60*60*1e3),t="; expires="+e.toUTCString()}document.cookie=e+"="+(s||"")+t+"; path=/"},getCookie=e=>{let s=e+"=",o=document.cookie.split(";");for(let e=0;e<o.length;e++){let t=o[e];for(;" "==t.charAt(0);)t=t.substring(1,t.length);if(0==t.indexOf(s))return t.substring(s.length,t.length)}return null},deleteCookie=e=>{document.cookie=e+"=; Path=/; Expires=Thu, 01 Jan 1970 00:00:01 GMT;"},hideCursor=()=>{mousetimeout=null,document.body.style.cursor="none",cursorvisible=!1},document.onmousemove=function(){mousetimeout&&window.clearTimeout(mouseTimer),cursorvisible||(document.body.style.cursor="default",cursorVisible=!0),mousetimeout=window.setTimeout(hideCursor,3e3)};